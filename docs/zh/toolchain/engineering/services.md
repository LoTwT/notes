# 服务

## 云服务器

云服务器又叫云主机或云计算服务器，简称 ECS ，是指简单高效、安全可靠、处理能力可弹性伸缩的计算服务。其管理方式比物理服务器更简单更高效，用户无需提前购买硬件就能迅速创建或释放任意多台云服务器。

云服务器可帮助开发者快速构建更稳定、更安全的应用，降低开发与运维的整体难度与整体成本。

云服务器的出现简化了整个前端工程化的流程，让开发者可以专注于核心业务的创新，以更小的成本接触前端开发外的更多领域。

### 选购

阿里云 > 腾讯云 > 华为云 > 其他

### 操作

工具准备，CMD 工具 ( 命令行工具 ) 和 FTP 工具 ( 文件传输工具 ) 。

Windows 选择 Cmder 和 FinalShell 。

我当前使用的是 VS Code SSH 和 WinSCP

```bash
# 登录服务器
# root 实例用户名
# aaa.bbb.ccc.ddd 实例公有 IP
ssh root@aaa.bbb.ccc.ddd

# 查看系统信息
lsb_release -a

# 断开实例
exit

# 连接服务器次数过多，可能需要如下操作
# 删除实例公有 IP 在 known_hosts 中的记录
ssh-keygen -R aaa.bbb.ccc.ddd

# 重命名主机名
hostname # 查看主机名
vim /etc/hostname # 修改主机名
shutdown -r now # 重启实例让新主机名生效
```

### 管理

`yum` 是在 Fedora 、RedHat 、CentOS 中的 Shell 软件包管理器。它基于 RPM 包管理，可从指定的服务器自动安装 RPM 包，可自动处理依赖性关系并一次性地安装所有依赖的软件包。

常用命令：

| 命令                  | 功能     |
| --------------------- | -------- |
| `yum install <pkg>`   | 安装     |
| `yum remove <pkg>`    | 卸载     |
| `yum upgrade <pkg>`   | 升级     |
| `yum downgrade <pkg>` | 降级     |
| `yum search <pkg>`    | 搜索     |
| `yum reinstall <pkg>` | 重装     |
| `yum list <pkg>`      | 罗列     |
| `yum info <pkg>`      | 信息     |
| `yum clean <pkg>`     | 清理缓存 |

## 域名

域名系统简称 DNS ，指一个将域名与 IP 地址相互映射的分布式数据库。DNS 使用 TCP 与 UDP 端口 53 ，对于每一级域名长度的限制是 63 个字符，域名总长度不能超过 253 个字符。

域名解析流程

1. 浏览器缓存：浏览器首先会在自身缓存中查找是否有该域名对应 IP 地址，命中则解析结束
1. 系统缓存：当浏览器缓存未命中该域名，则会自动检查用户计算机系统 Hosts 文件的 DNS 缓存中查找是否有该域名对应 IP 地址
1. 路由器缓存：当浏览器缓存与系统缓存都未命中该域名，则进入路由器缓存中检查 DNS 缓存中查找是否有该域名对应 IP 地址
1. 本地域名服务器：上述都未命中该域名，则请求本地域名服务器解析该域名。这台服务器一般在当前城市的某个角落，距离不会很远且性能良好，一般都会缓存域名解析结果，大约 80% 的域名解析到这里就完成了。
1. 根域名服务器：上述都未命中该域名，则请求根域名服务器解析该域名。收到请求后会查找区域文件记录，若无则将其管辖范围内顶级域名服务器的 IP 地址告知本地域名服务器

::: tip
全球仅有 13 台根域名服务器，1 台主根域名服务器，12 台辅根域名服务器
:::

1. 顶级域名服务器：本地域名服务器会发送请求给上一步返回的顶级域名服务器，顶级域名服务器收到请求后查找区域文件记录，若无则将其管辖范围内主域名服务器的 IP 地址告诉本地域名服务器
1. 主域名服务器：本地域名服务器会继续发送请求给上一步返回的主域名服务器，主域名服务器收到请求后查找自己的缓存，若无则返回相关下一级域名服务器的 IP 地址并重复该步骤直到找到正确记录
1. 保存结果到缓存：本地域名服务器把返回的结果保存到缓存中以备下一次使用，同时将该结果反馈给客户端，客户端通过该 IP 地址与 Web 服务器建立连接

域名记录由以下主要配置组成

- 记录类型：指向某个解析地址
- A：将域名指向一个 IPV4 地址
- CNAME：将域名指向另外一个域名
- AAAA：将域名指向一个 IPV6 地址
- NS：将子域名指向其他 DNS 服务器
- MX：将域名指向邮件服务器地址
- SRV：记录提供指定服务的服务器
- TXT：文本长度限制 512 ，通常做 SPF 记录
- CAA：CA 证书颁发机构授权校验
- 主机记录：域名形式
  - `@`：直接解析主域名 `xyz.com`
  - `*`：泛解析，匹配其他所有域名 `*.xyz.com`
  - `www`：将域名解析为 `www.xyz.com`
  - 二级域名：在域名前添加前缀，将域名解析为二级域名，如 abc.xyz.com
- 记录值：填写服务器公有 IP
