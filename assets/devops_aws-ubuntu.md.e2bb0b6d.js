import{_ as s,c as n,o as a,a as l}from"./app.a067e1d4.js";const C=JSON.parse('{"title":"AWS Ubuntu","description":"","frontmatter":{},"headers":[{"level":3,"title":"\u9996\u6B21\u767B\u9646","slug":"\u9996\u6B21\u767B\u9646","link":"#\u9996\u6B21\u767B\u9646","children":[]},{"level":3,"title":"\u914D\u7F6E root \u7528\u6237","slug":"\u914D\u7F6E-root-\u7528\u6237","link":"#\u914D\u7F6E-root-\u7528\u6237","children":[]},{"level":3,"title":"\u4FEE\u6539 ssh \u767B\u5F55\u65B9\u5F0F","slug":"\u4FEE\u6539-ssh-\u767B\u5F55\u65B9\u5F0F","link":"#\u4FEE\u6539-ssh-\u767B\u5F55\u65B9\u5F0F","children":[]},{"level":3,"title":"\u914D\u7F6E\u5F39\u6027 IP","slug":"\u914D\u7F6E\u5F39\u6027-ip","link":"#\u914D\u7F6E\u5F39\u6027-ip","children":[]},{"level":3,"title":"\u4FEE\u6539\u4E3B\u673A\u540D","slug":"\u4FEE\u6539\u4E3B\u673A\u540D","link":"#\u4FEE\u6539\u4E3B\u673A\u540D","children":[]},{"level":3,"title":"\u57DF\u540D\u89E3\u6790","slug":"\u57DF\u540D\u89E3\u6790","link":"#\u57DF\u540D\u89E3\u6790","children":[]},{"level":3,"title":"\u5B89\u88C5 node","slug":"\u5B89\u88C5-node","link":"#\u5B89\u88C5-node","children":[]},{"level":3,"title":"\u5B89\u88C5 pm2","slug":"\u5B89\u88C5-pm2","link":"#\u5B89\u88C5-pm2","children":[]},{"level":3,"title":"\u90E8\u7F72 nuxt3 ssr","slug":"\u90E8\u7F72-nuxt3-ssr","link":"#\u90E8\u7F72-nuxt3-ssr","children":[]},{"level":3,"title":"\u8BBF\u95EE\u52A0\u5BC6","slug":"\u8BBF\u95EE\u52A0\u5BC6","link":"#\u8BBF\u95EE\u52A0\u5BC6","children":[]}],"relativePath":"devops/aws-ubuntu.md","lastUpdated":1669599731000}'),e={name:"devops/aws-ubuntu.md"},p=l(`<h1 id="aws-ubuntu" tabindex="-1">AWS Ubuntu <a class="header-anchor" href="#aws-ubuntu" aria-hidden="true">#</a></h1><p>\u8BB0\u5F55\u5728 aws \u4E0A\u542F\u52A8 ubuntu \u5B9E\u4F8B\u7684\u8FC7\u7A0B\u3002</p><h3 id="\u9996\u6B21\u767B\u9646" tabindex="-1">\u9996\u6B21\u767B\u9646 <a class="header-anchor" href="#\u9996\u6B21\u767B\u9646" aria-hidden="true">#</a></h3><p>\u8FDB\u5165 ec2 \u5B9E\u4F8B\u9762\u677F</p><ul><li>\u70B9\u51FB\u53F3\u4E0A\u89D2\u8FDE\u63A5</li><li>\u9009\u62E9 SSH \u5BA2\u6237\u7AEF</li><li>\u547D\u4EE4\u884C\u8FDB\u5165 pem \u79D8\u94A5\u76EE\u5F55\u4E0B\uFF0C\u6839\u636E\u63D0\u793A\u64CD\u4F5C</li></ul><p>\u5982\u679C\u662F Windows \u7CFB\u7EDF\uFF0CAWS \u8FDE\u63A5\u5230\u5B9E\u4F8B\u7684\u7B2C\u4E09\u6B65\u9700\u8981\u6539\u4E3A</p><ul><li>\u6211\u7684\u7535\u8111\u8FDB\u5165 pem \u79D8\u94A5\u76EE\u5F55</li><li>\u53F3\u952E\u5C5E\u6027</li><li>tab \u9875\u9009\u62E9\u5B89\u5168\uFF0C\u70B9\u51FB\u4E0B\u65B9\u9AD8\u7EA7\u6309\u94AE</li><li>\u6839\u636E\u9700\u8981\u66F4\u6539\u6240\u6709\u8005</li><li>\u7981\u7528\u7EE7\u627F\uFF0C\u9009\u5220\u9664\u6240\u6709</li><li>\u70B9\u51FB\u6DFB\u52A0\uFF0C\u9009\u62E9\u4E3B\u4F53\uFF0C\u8BBE\u7F6E\u5B8C\u5168\u63A7\u5236</li><li>\u547D\u4EE4\u884C\u8FDB\u5165 pem \u76EE\u5F55\uFF0C\u8FDB\u884C\u7B2C\u56DB\u6B65</li></ul><h3 id="\u914D\u7F6E-root-\u7528\u6237" tabindex="-1">\u914D\u7F6E root \u7528\u6237 <a class="header-anchor" href="#\u914D\u7F6E-root-\u7528\u6237" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u8BBE\u7F6E root \u7528\u6237\u5BC6\u7801</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo passwd root</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u4E5F\u53EF\u540C\u65F6\u8BBE\u7F6E ubuntu \u7528\u6237\u5BC6\u7801 ( AWS \u9ED8\u8BA4\u7528\u6237 )</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo passwd ubuntu</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5207\u6362\u5230 root \u7528\u6237</span></span>
<span class="line"><span style="color:#A6ACCD;">su root</span></span>
<span class="line"></span></code></pre></div><h3 id="\u4FEE\u6539-ssh-\u767B\u5F55\u65B9\u5F0F" tabindex="-1">\u4FEE\u6539 ssh \u767B\u5F55\u65B9\u5F0F <a class="header-anchor" href="#\u4FEE\u6539-ssh-\u767B\u5F55\u65B9\u5F0F" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">vim /etc/ssh/sshd_config</span></span>
<span class="line"></span></code></pre></div><p>\u5C06 <code>PasswordAuthentication</code> \u6539\u4E3A <code>yes</code> \uFF0C<code>PermitRootLogin</code> \u6539\u4E3A <code>yes</code></p><p>\u91CD\u542F sshd</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sudo /sbin/service sshd restart</span></span>
<span class="line"></span></code></pre></div><p>\u9000\u51FA\u540E\u5373\u53EF\u4F7F\u7528 root \u767B\u5F55</p><h3 id="\u914D\u7F6E\u5F39\u6027-ip" tabindex="-1">\u914D\u7F6E\u5F39\u6027 IP <a class="header-anchor" href="#\u914D\u7F6E\u5F39\u6027-ip" aria-hidden="true">#</a></h3><p>\u5982\u679C\u8003\u8651\u5230\u4EE5\u540E\u53EF\u80FD\u53D1\u751F\u7684\u5404\u79CD\u610F\u5916\uFF0C\u53EF\u4EE5\u914D\u7F6E\u4E00\u4E2A\u4E13\u95E8\u7684\u5F39\u6027 IP \u5173\u8054\u5230\u5B9E\u4F8B\uFF0C\u9632\u6B62\u5B9E\u4F8B\u56E0\u5404\u79CD\u95EE\u9898\u5BFC\u81F4 IP \u6539\u53D8\u540E\u9700\u8981\u91CD\u65B0\u914D\u7F6E\u3002</p><ul><li>\u5DE6\u4FA7\u83DC\u5355\u9009\u62E9\u5F39\u6027 IP</li><li>\u70B9\u51FB\u53F3\u4E0A\u89D2\u5206\u914D\u5F39\u6027 IP \u5730\u5740</li><li>\u6839\u636E\u63D0\u793A\u5173\u8054\u5B9E\u4F8B\u5373\u53EF</li></ul><p>\u914D\u7F6E\u597D\u540E\uFF0C\u5B9E\u4F8B\u7684\u5171\u6709 IPv4 \u5730\u5740\u5C06\u88AB\u8BBE\u7F6E\u4E3A\u7533\u8BF7\u5230\u7684\u5F39\u6027 IP \u5730\u5740\uFF0Cssh \u5373\u53EF\u901A\u8FC7\u8BE5 IP \u5730\u5740\u767B\u5F55\u3002</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ssh root@aaa.bbb.ccc.ddd</span></span>
<span class="line"></span></code></pre></div><h3 id="\u4FEE\u6539\u4E3B\u673A\u540D" tabindex="-1">\u4FEE\u6539\u4E3B\u673A\u540D <a class="header-anchor" href="#\u4FEE\u6539\u4E3B\u673A\u540D" aria-hidden="true">#</a></h3><p>\u9ED8\u8BA4\u4E3B\u673A\u540D\u6BD4\u8F83\u96BE\u4EE5\u9605\u8BFB\uFF0C\u53EF\u4EE5\u6539\u4E2A\u559C\u6B22\u7684\u540D\u5B57\u3002</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u67E5\u770B\u4E3B\u673A\u540D</span></span>
<span class="line"><span style="color:#A6ACCD;">hostname</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u4FEE\u6539\u4E3B\u673A\u540D</span></span>
<span class="line"><span style="color:#A6ACCD;">vim /etc/hostname</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u91CD\u542F\u5B9E\u4F8B\u8BA9\u65B0\u4E3B\u673A\u540D\u751F\u6548</span></span>
<span class="line"><span style="color:#A6ACCD;">shutdown -r now</span></span>
<span class="line"></span></code></pre></div><p>\u91CD\u542F\u5B9E\u4F8B\u4F1A\u5F3A\u5236\u4E2D\u65AD ssh \u8FDE\u63A5\uFF0C\u5E76\u82B1\u8D39\u4E00\u4E9B\u65F6\u95F4\uFF0C\u7A0D\u7B49\u7247\u523B\u540E\u91CD\u65B0\u767B\u5F55\u5373\u53EF\u3002</p><h3 id="\u57DF\u540D\u89E3\u6790" tabindex="-1">\u57DF\u540D\u89E3\u6790 <a class="header-anchor" href="#\u57DF\u540D\u89E3\u6790" aria-hidden="true">#</a></h3><ul><li>\u8FDB\u5165 aws \u63A7\u5236\u53F0\u4E3B\u9875\uFF0C\u9009\u62E9 Route 53</li><li>\u5DE6\u4FA7\u9009\u62E9\u6258\u7BA1\u533A\u57DF\uFF0C\u9009\u62E9\u8981\u89E3\u6790\u7684\u57DF\u540D</li><li>\u521B\u5EFA\u8BB0\u5F55\uFF0C\u586B\u5199\u5177\u4F53\u89C4\u5219\u5373\u53EF</li></ul><p>\u5177\u4F53\u89C4\u5219\u8BF7\u67E5\u770B <a href="./../toolchain/engineering/services.html#\u57DF\u540D">\u57DF\u540D</a> \u3002</p><h3 id="\u5B89\u88C5-node" tabindex="-1">\u5B89\u88C5 node <a class="header-anchor" href="#\u5B89\u88C5-node" aria-hidden="true">#</a></h3><ol><li><p>\u4E0B\u8F7D\u60F3\u8981\u7684 Linux \u7248\u672C node \u5B89\u88C5\u5305\u5E76\u7528 FTP \u5DE5\u5177\u4E0A\u4F20\u6216 <code>wget https://nodejs.org/dist/v16.15.0/node-v16.15.0-linux-x64.tar.xz</code></p></li><li><p>\u89E3\u538B <code>tar xf node-v16.15.0-linux-x64.tar.xz</code></p></li><li><p>\u8BBE\u7F6E\u8F6F\u8FDE\u63A5</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ln -s \u5B89\u88C5\u76EE\u5F55/bin/npm   /usr/bin/</span></span>
<span class="line"><span style="color:#A6ACCD;">ln -s \u5B89\u88C5\u76EE\u5F55/bin/node   /usr/bin/</span></span>
<span class="line"></span></code></pre></div></li></ol><h3 id="\u5B89\u88C5-pm2" tabindex="-1">\u5B89\u88C5 pm2 <a class="header-anchor" href="#\u5B89\u88C5-pm2" aria-hidden="true">#</a></h3><p>\u5B89\u88C5\u5B8C node \u540E</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">npm i pm2 -g</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i pm2 --location=global</span></span>
<span class="line"></span></code></pre></div><p>\u8BBE\u7F6E\u8F6F\u8FDE\u63A5</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ln -s node\u5B89\u88C5\u76EE\u5F55/lib/node_modules/pm2/bin/pm2   /usr/bin/</span></span>
<span class="line"></span></code></pre></div><h3 id="\u90E8\u7F72-nuxt3-ssr" tabindex="-1">\u90E8\u7F72 nuxt3 ssr <a class="header-anchor" href="#\u90E8\u7F72-nuxt3-ssr" aria-hidden="true">#</a></h3><ul><li><p>\u5C06 <code>nuxi build</code> \u6784\u5EFA\u597D\u7684\u4EE3\u7801\u4E0A\u4F20\u5230\u670D\u52A1\u5668\uFF0C\u9ED8\u8BA4\u7AEF\u53E3 3000</p></li><li><p>\u4F7F\u7528 pm2 \u542F\u52A8\u5165\u53E3\u6587\u4EF6 <code>pm2 start \u76EE\u5F55/server/index.mjs --name \u540D\u5B57</code></p></li><li><p>\u914D\u7F6E nginx</p><p><code>xxx.yyy</code> \u4E3A\u57DF\u540D</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u6DFB\u52A0\u5BF9\u5E94\u57DF\u540D\u914D\u7F6E</span></span>
<span class="line"><span style="color:#A6ACCD;">vim /etc/nginx/conf.d/xxx.yyy.conf</span></span>
<span class="line"></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">  listen 80;</span></span>
<span class="line"><span style="color:#A6ACCD;">  server_name xxx.yyy www.xxx.yyy;</span></span>
<span class="line"><span style="color:#A6ACCD;">  location / {</span></span>
<span class="line"><span style="color:#A6ACCD;">    proxy_pass http://127.0.0.1:3000;</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li></ul><h3 id="\u8BBF\u95EE\u52A0\u5BC6" tabindex="-1">\u8BBF\u95EE\u52A0\u5BC6 <a class="header-anchor" href="#\u8BBF\u95EE\u52A0\u5BC6" aria-hidden="true">#</a></h3><p>\u5B89\u88C5 certbot</p><p>AWS Ubuntu \u81EA\u5E26\u4E86 snap \uFF0C\u76F4\u63A5\u4F7F\u7528\u5373\u53EF\uFF1B\u5982\u679C\u6CA1\u6709\uFF0C\u8BF7\u81EA\u884C\u5B89\u88C5\u3002</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u5F00\u542F\u81EA\u542F</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl </span><span style="color:#82AAFF;">enable</span><span style="color:#A6ACCD;"> --now snapd.socket</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">snap install core</span></span>
<span class="line"><span style="color:#A6ACCD;">snap refresh core</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5B89\u88C5 certbot</span></span>
<span class="line"><span style="color:#A6ACCD;">snap install --classic certbot</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u8F6F\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ln -s /snap/bin/certbot /usr/bin/certbot</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u67E5\u770B\u7248\u672C</span></span>
<span class="line"><span style="color:#A6ACCD;">certbot --version</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u626B\u63CF nginx \u6240\u6709\u914D\u7F6E\uFF0C\u5BF9\u5E94\u8F93\u5165\u7B54\u6848</span></span>
<span class="line"><span style="color:#A6ACCD;">certbot --nginx</span></span>
<span class="line"></span></code></pre></div><p>HTTPS \u8BC1\u4E66\u6700\u7EC8\u751F\u6210\u5230 <code>/etc/letsencrypt/live/aaa.bbb</code> \u76EE\u5F55\u4E0B\u3002</p>`,41),o=[p];function i(c,t,r,d,h,u){return a(),n("div",null,o)}const y=s(e,[["render",i]]);export{C as __pageData,y as default};
